{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/kamku/Desktop/Proyecto_registro/RegistroCivil/RegistroCivil/ClientApp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"../registro.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/common\";\n\nfunction RegistroFormComponent_h1_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h1\");\n    i0.ɵɵtext(1, \"A\\u00F1adir registros\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction RegistroFormComponent_h1_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h1\");\n    i0.ɵɵtext(1, \"Editar registros\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nconst _c0 = function () {\n  return [\"/registro\"];\n};\n\nexport class RegistroFormComponent {\n  //constructor con injecciones de servicios\n  constructor(fb, registroSerices, router, activatedRoute) {\n    this.fb = fb;\n    this.registroSerices = registroSerices;\n    this.router = router;\n    this.activatedRoute = activatedRoute;\n    this.edicionRegistro = false;\n    this.registrosCoinciden = 0;\n  }\n\n  ngOnInit() {\n    this.formGroup = this.fb.group({\n      numeroIdentificacion: '',\n      nombre: '',\n      apellido: '',\n      sexo: '',\n      fechaNacimiento: '',\n      hora: '',\n      monoparental: false\n    });\n    this.activatedRoute.params.subscribe(params => {\n      if (params[\"id\"] == undefined) {\n        //console.log(this.edicionRegistro)\n        return;\n      } else {\n        this.edicionRegistro = true;\n        this.registroID = params[\"id\"];\n        this.registroSerices.getRegistro(this.registroID.toString()).subscribe(registro => this.cargarFormulario(registro), error => console.error(error)); //console.log(this.edicionRegistro)\n      }\n    });\n  }\n\n  cargarFormulario(registro) {\n    let date = new Date(registro.fechaNacimiento);\n    const dateField = date.toISOString().substring(0, 10);\n    let h = date.getHours() >= 10 ? date.getHours() : '0' + date.getHours();\n    let m = date.getMinutes() >= 10 ? date.getMinutes() : '0' + date.getMinutes();\n    this.formGroup.patchValue({\n      numeroIdentificacion: registro.numeroIdentificacion.substring(0, 2),\n      nombre: registro.nombre,\n      apellido: registro.apellido,\n      sexo: registro.sexo,\n      fechaNacimiento: dateField,\n      hora: h + \":\" + m,\n      monoparental: registro.monoparental\n    }); //console.log(this.formGroup.value.numeroIdentificacion)\n\n    /* console.log(this.edicionRegistro)\r\n     console.log(date.toISOString().substring(11, 16))\r\n       c this.formGroup.controls['fechaNacimiento'].setValue(date.getFullYear() + '-' + date.getMonth() + '-' + date.getDate());\r\n     this.fechaVal = date.getDate() + \"-\" + date.getMonth() + \"-\" + date.getFullYear();\r\n     onsole.table(date.toLocaleDateString())\r\n     console.table(date.getFullYear() + \"-\" + date.getMonth() + \"-\" + date.getDate())\r\n    */\n  }\n\n  save() {\n    this.formGroup.value.fechaNacimiento = this.gestionFecha(this.formGroup.value.fechaNacimiento, this.formGroup.value.hora);\n    delete this.formGroup.value.hora;\n    this.formGroup.value.numeroIdentificacion = this.gestionNumeroIDentificacion(this.formGroup.value.numeroIdentificacion);\n    let registro = Object.assign({}, this.formGroup.value);\n    /*  console.log(registro)\r\n     this.comprobarNumeroIdentificaion(this.formGroup.value.numeroIdentificacion.toString()); */\n\n    return;\n\n    if (this.edicionRegistro) {\n      //edit\n      console.log(\"editar\");\n      registro.registroID = this.registroID;\n      this.registroSerices.actualizarRegistro(registro).subscribe(() => this.Registrado(), error => console.error(error));\n      return;\n    } else {\n      //crear\n      console.log(\"Registrar\"); //console.log(registro)\n\n      this.registroSerices.crearRegistro(registro).subscribe(() => this.Registrado(), error => console.error(error));\n    }\n  }\n\n  Registrado() {\n    this.router.navigate([\"/registros\"]);\n  }\n\n  gestionFecha(fecha, hora) {\n    let auxF = fecha.split('-');\n    let auxH = hora.split(':'); // console.log(parseInt(auxH[0]) + 1)\n    // console.log(auxF+\" \"+auxH)\n\n    let datetime = new Date(parseInt(auxF[0]), parseInt(auxF[1]) - 1, parseInt(auxF[2]), parseInt(auxH[0]) + 1, parseInt(auxH[1])); //console.log(datetime.getHours()+\"*--------------------\")\n    //console.log(datetime.toJSON())\n\n    return datetime.toJSON();\n  }\n\n  gestionNumeroIDentificacion(cm) {\n    let nIdentificacion;\n    let aux0 = false;\n\n    do {\n      const na1 = Math.floor(Math.random() * 10);\n      const na2 = Math.floor(Math.random() * 10);\n      const na3 = Math.floor(Math.random() * 10);\n      const na4 = Math.floor(Math.random() * 10);\n      nIdentificacion = cm + \"\" + na1 + \"\" + na2 + \"\" + na3 + \"\" + na4;\n      aux0 = this.comprobarNumeroIdentificaion(nIdentificacion);\n    } while (aux0);\n\n    asc;\n    console.log(nIdentificacion);\n    return nIdentificacion;\n  }\n\n  comprobarNumeroIdentificaion(nIden) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      let existe = false;\n      yield _this.registroSerices.getRegistros().subscribe(responce => {\n        if (responce.filter(reg => reg.numeroIdentificacion == nIden).length > 0) {\n          existe = true; //  console.log(responce.filter(reg => reg.numeroIdentificacion == 'MA253'))\n        }\n      }, error => console.error(error));\n      console.log(existe);\n      return yield existe;\n    })();\n  }\n\n}\n\nRegistroFormComponent.ɵfac = function RegistroFormComponent_Factory(t) {\n  return new (t || RegistroFormComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.RegistroService), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i3.ActivatedRoute));\n};\n\nRegistroFormComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: RegistroFormComponent,\n  selectors: [[\"app-registro-form\"]],\n  decls: 86,\n  vars: 5,\n  consts: [[1, \"container\"], [1, \"row\", \"justify-content-center\"], [1, \"col-10\", \"col-md-12\"], [4, \"ngIf\"], [1, \"form\", \"shadow-lg\", 3, \"formGroup\", \"ngSubmit\"], [1, \"col\"], [\"for\", \"nombre\"], [\"type\", \"text\", \"id\", \"nombre\", \"formControlName\", \"nombre\", 1, \"form-control\"], [\"for\", \"apellido\"], [\"type\", \"text\", \"id\", \"apellido\", \"formControlName\", \"apellido\", 1, \"form-control\"], [\"for\", \"numeroIdentificacion\"], [\"name\", \"ddlNumeroIdentificaion\", \"id\", \"numeroIdentificacion\", \"formControlName\", \"numeroIdentificacion\", 1, \"form-control\"], [\"value\", \"\"], [\"value\", \"AN\"], [\"value\", \"AR\"], [\"value\", \"AS\"], [\"value\", \"IB\"], [\"value\", \"CN\"], [\"value\", \"CB\"], [\"value\", \"CM\"], [\"value\", \"CL\"], [\"value\", \"CT\"], [\"value\", \"CE\"], [\"value\", \"VC\"], [\"value\", \"EX\"], [\"value\", \"GA\"], [\"value\", \"MD\"], [\"value\", \"ML\"], [\"value\", \"MU\"], [\"value\", \"NA\"], [\"value\", \"PV\"], [\"value\", \"RI\"], [\"for\", \"sexo\"], [\"id\", \"ddlSexoFrom\", \"formControlName\", \"sexo\", 1, \"form-control\"], [\"value\", \"F\"], [\"value\", \"M\"], [\"for\", \"fechaNacimiento\"], [\"type\", \"date\", \"id\", \"fechaNacimiento\", \"formControlName\", \"fechaNacimiento\", 1, \"form-control\"], [\"for\", \"hora\"], [\"type\", \"time\", \"id\", \"hora\", \"formControlName\", \"hora\", 1, \"form-control\"], [\"for\", \"monoparental\"], [\"type\", \"checkbox\", \"id\", \"monoparental\", \"formControlName\", \"monoparental\", 1, \"form-check\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\"], [1, \"btn\", \"btn-danger\", 3, \"routerLink\"]],\n  template: function RegistroFormComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2);\n      i0.ɵɵtemplate(3, RegistroFormComponent_h1_3_Template, 2, 0, \"h1\", 3);\n      i0.ɵɵtemplate(4, RegistroFormComponent_h1_4_Template, 2, 0, \"h1\", 3);\n      i0.ɵɵelementStart(5, \"form\", 4);\n      i0.ɵɵlistener(\"ngSubmit\", function RegistroFormComponent_Template_form_ngSubmit_5_listener() {\n        return ctx.save();\n      });\n      i0.ɵɵelementStart(6, \"fieldset\")(7, \"div\", 5)(8, \"label\", 6);\n      i0.ɵɵtext(9, \"Nombre\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(10, \"input\", 7);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(11, \"div\", 5)(12, \"label\", 8);\n      i0.ɵɵtext(13, \"Apellido\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(14, \"input\", 9);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(15, \"div\", 5)(16, \"label\", 10);\n      i0.ɵɵtext(17, \"Comunidad Autonoma\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(18, \"select\", 11)(19, \"option\", 12);\n      i0.ɵɵtext(20, \"--- Seleccione Comunidad Autonoma ---\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(21, \"option\", 13);\n      i0.ɵɵtext(22, \"Andaluc\\u00EDa\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(23, \"option\", 14);\n      i0.ɵɵtext(24, \"Arag\\u00F3n\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(25, \"option\", 15);\n      i0.ɵɵtext(26, \"Asturias\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(27, \"option\", 16);\n      i0.ɵɵtext(28, \"Baleares\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(29, \"option\", 17);\n      i0.ɵɵtext(30, \"Canarias\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(31, \"option\", 18);\n      i0.ɵɵtext(32, \"Cantabria\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(33, \"option\", 19);\n      i0.ɵɵtext(34, \"Castilla-La Mancha\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(35, \"option\", 20);\n      i0.ɵɵtext(36, \"Castilla y Le\\u00F3n\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(37, \"option\", 21);\n      i0.ɵɵtext(38, \"Catalu\\u00F1a\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(39, \"option\", 22);\n      i0.ɵɵtext(40, \"Ceuta\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(41, \"option\", 23);\n      i0.ɵɵtext(42, \"Comunidad Valenciana\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(43, \"option\", 24);\n      i0.ɵɵtext(44, \"Extremadura\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(45, \"option\", 25);\n      i0.ɵɵtext(46, \"Galicia\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(47, \"option\", 26);\n      i0.ɵɵtext(48, \"Madrid\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(49, \"option\", 27);\n      i0.ɵɵtext(50, \"Melilla\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(51, \"option\", 28);\n      i0.ɵɵtext(52, \"Murcia\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(53, \"option\", 29);\n      i0.ɵɵtext(54, \"Navarra\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(55, \"option\", 30);\n      i0.ɵɵtext(56, \"Pa\\u00EDs Vasco\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(57, \"option\", 31);\n      i0.ɵɵtext(58, \"La Rioja\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(59, \"div\", 5)(60, \"label\", 32);\n      i0.ɵɵtext(61, \"Sexo\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(62, \"select\", 33)(63, \"option\", 12);\n      i0.ɵɵtext(64, \"--- Selecciona un Sexo ---\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(65, \"option\", 34);\n      i0.ɵɵtext(66, \"Femenino\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(67, \"option\", 35);\n      i0.ɵɵtext(68, \"Masculino\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(69, \"div\", 5)(70, \"label\", 36);\n      i0.ɵɵtext(71, \"Fecha de Nacimiento\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(72, \"input\", 37);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(73, \"div\", 5)(74, \"label\", 38);\n      i0.ɵɵtext(75, \"Hora de Nacimiento\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(76, \"input\", 39);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(77, \"div\", 5)(78, \"label\", 40);\n      i0.ɵɵtext(79, \"Familia monoparental\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(80, \"input\", 41);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(81, \"div\", 5)(82, \"button\", 42);\n      i0.ɵɵtext(83, \"Enviar\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(84, \"button\", 43);\n      i0.ɵɵtext(85, \"Cancel\");\n      i0.ɵɵelementEnd()()()()()();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngIf\", !ctx.edicionRegistro);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.edicionRegistro);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"formGroup\", ctx.formGroup);\n      i0.ɵɵadvance(79);\n      i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(4, _c0));\n    }\n  },\n  dependencies: [i4.NgIf, i1.ɵNgNoValidate, i1.NgSelectOption, i1.ɵNgSelectMultipleOption, i1.DefaultValueAccessor, i1.CheckboxControlValueAccessor, i1.SelectControlValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i1.FormGroupDirective, i1.FormControlName, i3.RouterLink],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJyZWdpc3Ryby1mb3JtLmNvbXBvbmVudC5jc3MifQ== */\"]\n});","map":{"version":3,"mappings":"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","names":["i0","RegistroFormComponent","constructor","fb","registroSerices","router","activatedRoute","ngOnInit","formGroup","group","numeroIdentificacion","nombre","apellido","sexo","fechaNacimiento","hora","monoparental","params","subscribe","undefined","edicionRegistro","registroID","getRegistro","toString","registro","cargarFormulario","error","console","date","Date","dateField","toISOString","substring","h","getHours","m","getMinutes","patchValue","save","value","gestionFecha","gestionNumeroIDentificacion","Object","assign","log","actualizarRegistro","Registrado","crearRegistro","navigate","fecha","auxF","split","auxH","datetime","parseInt","toJSON","cm","nIdentificacion","aux0","na1","Math","floor","random","na2","na3","na4","comprobarNumeroIdentificaion","asc","nIden","existe","getRegistros","responce","filter","reg","length","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["C:\\Users\\kamku\\Desktop\\Proyecto_registro\\RegistroCivil\\RegistroCivil\\ClientApp\\src\\app\\registro\\registro-form\\registro-form.component.html","C:\\Users\\kamku\\Desktop\\Proyecto_registro\\RegistroCivil\\RegistroCivil\\ClientApp\\src\\app\\registro\\registro-form\\registro-form.component.ts"],"sourcesContent":["<div class=\"container\">\n    <div class=\"row justify-content-center\">\n        <div class=\"col-10 col-md-12\">\n            <h1 *ngIf=\"!edicionRegistro\">Añadir registros</h1>\n            <h1 *ngIf=\"edicionRegistro\">Editar registros</h1>\n            <form class=\"form shadow-lg \" (ngSubmit)=\"save()\" [formGroup]=\"formGroup\">\n                <fieldset>\n                    <div class=\"col\">\n                        <label for=\"nombre\">Nombre</label>\n                        <input type=\"text\" class=\" form-control\"\n                            id=\"nombre\"\n                            formControlName=\"nombre\"\n                        >\n                    </div>\n                    \n                    <div class=\"col\">\n                        <label for=\"apellido\">Apellido</label>\n                        <input type=\"text\" class=\" form-control\"\n                            id=\"apellido\"\n                            formControlName=\"apellido\"\n                        >\n                    </div>\n                    <div class=\"col\">\n                        <label for=\"numeroIdentificacion\">Comunidad Autonoma</label>\n                     <!--    <input type=\"text\" class=\" form-control\"\n                            id=\"numeroIdentificacion\"\n                            formControlName=\"numeroIdentificacion\"\n                        > -->\n                        <select name=\"ddlNumeroIdentificaion\" \n                        class=\" form-control\" id=\"numeroIdentificacion\"\n                        formControlName=\"numeroIdentificacion\">\n                            <option value=\"\">--- Seleccione Comunidad Autonoma ---</option>\n                            <option value=\"AN\">Andalucía</option>\n                            <option value=\"AR\">Aragón</option>\n                            <option value=\"AS\">Asturias</option>\n                            <option value=\"IB\">Baleares</option>\n                            <option value=\"CN\">Canarias</option>\n                            <option value=\"CB\">Cantabria</option>\n                            <option value=\"CM\">Castilla-La Mancha</option>\n                            <option value=\"CL\">Castilla y León</option>\n                            <option value=\"CT\">Cataluña</option>\n                            <option value=\"CE\">Ceuta</option>\n                            <option value=\"VC\">Comunidad Valenciana</option>\n                            <option value=\"EX\">Extremadura</option>\n                            <option value=\"GA\">Galicia</option>\n                            <option value=\"MD\">Madrid</option>\n                            <option value=\"ML\">Melilla</option>\n                            <option value=\"MU\">Murcia</option>\n                            <option value=\"NA\">Navarra</option>\n                            <option value=\"PV\">País Vasco</option>\n                            <option value=\"RI\">La Rioja</option>\n                        </select>\n\n                    </div>\n                    <div class=\"col\">\n                        <label for=\"sexo\">Sexo</label>\n                       \n                        <select class=\" form-control\" id=\"ddlSexoFrom\" formControlName=\"sexo\">\n                            <option value=\"\">--- Selecciona un Sexo ---</option>\n                            <option value=\"F\">Femenino</option>\n                            <option value=\"M\">Masculino</option>\n                        </select>\n                    </div>\n                    <div class=\"col\">\n                        <label for=\"fechaNacimiento\">Fecha de Nacimiento</label>\n                        <input type=\"date\" class=\" form-control\"\n                            id=\"fechaNacimiento\"\n                            formControlName=\"fechaNacimiento\"\n                        >\n                    </div>\n                    <div class=\"col\">\n                        <label for=\"hora\">Hora de Nacimiento</label>\n                        <input type=\"time\" class=\" form-control\"\n                            id=\"hora\"\n                            formControlName=\"hora\"\n                            >\n                    </div>\n                    \n                    <div class=\"col\">\n                        <label for=\"monoparental\">Familia monoparental</label>\n                        <input type=\"checkbox\" class=\" form-check\"\n                            id=\"monoparental\"\n                            formControlName=\"monoparental\"\n                        >\n                    </div>\n\n                </fieldset>\n                <div class=\" col\">\n                    <button class=\"btn btn-primary\" type=\"submit\">Enviar</button>\n                    <button class=\"btn btn-danger\" [routerLink]='[\"/registro\"]'>Cancel</button>\n                </div>\n            </form>\n        </div>\n    </div>\n</div>","import { Component, Directive, Input, OnInit } from '@angular/core';\nimport { FormBuilder, FormGroup } from '@angular/forms';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { finalize } from 'rxjs';\nimport { IRegistro } from '../iregistro';\nimport { RegistroService } from '../registro.service';\n\n\n@Component({\n  selector: 'app-registro-form',\n  templateUrl: './registro-form.component.html',\n  styleUrls: ['./registro-form.component.css']\n})\n\n\n\nexport class RegistroFormComponent implements OnInit {\n\n  //constructor con injecciones de servicios\n  constructor(private fb: FormBuilder,\n    private registroSerices: RegistroService,\n    private router: Router,\n    private activatedRoute: ActivatedRoute) { }\n\n  //variables\n  formGroup!: FormGroup;\n  edicionRegistro: boolean = false;\n  registroID!: number;\n  fechaVal!: Date;\n  public registrosCoinciden: number = 0;\n\n\n  ngOnInit(): void {\n\n    this.formGroup = this.fb.group({\n      numeroIdentificacion: '',\n      nombre: '',\n      apellido: '',\n      sexo: '',\n      fechaNacimiento: '',\n      hora: '',\n      monoparental: false\n    });\n\n    this.activatedRoute.params.subscribe(params => {\n      if (params[\"id\"] == undefined) {\n        //console.log(this.edicionRegistro)\n\n        return;\n      } else {\n        this.edicionRegistro = true;\n        this.registroID = params[\"id\"];\n        this.registroSerices.getRegistro(this.registroID.toString())\n          .subscribe((registro) => this.cargarFormulario(registro), error => console.error(error));\n        //console.log(this.edicionRegistro)\n\n      }\n    });\n  }\n\n  cargarFormulario(registro: IRegistro) {\n    let date = new Date(registro.fechaNacimiento);\n    const dateField = date.toISOString().substring(0, 10);\n    let h = date.getHours() >= 10 ? date.getHours() : '0' + date.getHours();\n    let m = date.getMinutes() >= 10 ? date.getMinutes() : '0' + date.getMinutes();\n\n    this.formGroup.patchValue({\n      numeroIdentificacion: registro.numeroIdentificacion.substring(0, 2),\n      nombre: registro.nombre,\n      apellido: registro.apellido,\n      sexo: registro.sexo,\n      fechaNacimiento: dateField,\n      hora: h + \":\" + m,\n      monoparental: registro.monoparental\n    })\n    //console.log(this.formGroup.value.numeroIdentificacion)\n    /* console.log(this.edicionRegistro)\n     console.log(date.toISOString().substring(11, 16))\n       c this.formGroup.controls['fechaNacimiento'].setValue(date.getFullYear() + '-' + date.getMonth() + '-' + date.getDate());\n     this.fechaVal = date.getDate() + \"-\" + date.getMonth() + \"-\" + date.getFullYear();\n     onsole.table(date.toLocaleDateString())\n     console.table(date.getFullYear() + \"-\" + date.getMonth() + \"-\" + date.getDate())\n  */\n  }\n\n  save() {\n\n    this.formGroup.value.fechaNacimiento = this.gestionFecha(this.formGroup.value.fechaNacimiento, this.formGroup.value.hora);\n    delete this.formGroup.value.hora;\n    this.formGroup.value.numeroIdentificacion = this.gestionNumeroIDentificacion(this.formGroup.value.numeroIdentificacion);\n\n    let registro: IRegistro = Object.assign({}, this.formGroup.value);\n    /*  console.log(registro)\n     this.comprobarNumeroIdentificaion(this.formGroup.value.numeroIdentificacion.toString()); */\n    return;\n    if (this.edicionRegistro) {\n      //edit\n      console.log(\"editar\")\n      registro.registroID = this.registroID;\n      this.registroSerices.actualizarRegistro(registro)\n        .subscribe(() => this.Registrado(), error => console.error(error));\n      return;\n    } else {\n      //crear\n      console.log(\"Registrar\")\n\n      //console.log(registro)\n      this.registroSerices.crearRegistro(registro)\n        .subscribe(() => this.Registrado(), error => console.error(error))\n    }\n\n  }\n\n  Registrado() {\n    this.router.navigate([\"/registros\"]);\n  }\n\n  gestionFecha(fecha: string, hora: string): string {\n\n    let auxF: string[] = fecha.split('-')\n    let auxH: string[] = hora.split(':')\n    // console.log(parseInt(auxH[0]) + 1)\n    // console.log(auxF+\" \"+auxH)\n    let datetime: Date = new Date(parseInt(auxF[0]), parseInt(auxF[1]) - 1, parseInt(auxF[2]), parseInt(auxH[0]) + 1, parseInt(auxH[1]))\n    //console.log(datetime.getHours()+\"*--------------------\")\n    //console.log(datetime.toJSON())\n\n    return datetime.toJSON();\n  }\n  gestionNumeroIDentificacion(cm: string): string {\n\n    let nIdentificacion: string;\n    let aux0:any=false;\n    do {\n      const na1 = Math.floor(Math.random() * 10);\n      const na2 = Math.floor(Math.random() * 10);\n      const na3 = Math.floor(Math.random() * 10);\n      const na4 = Math.floor(Math.random() * 10);\n      nIdentificacion = cm + \"\" + na1 + \"\" + na2 + \"\" + na3 + \"\" + na4;\n     aux0 = this.comprobarNumeroIdentificaion(nIdentificacion)\n    } while (aux0)asc\n    console.log(nIdentificacion)\n    return nIdentificacion;\n  }\n\n  async comprobarNumeroIdentificaion(nIden: string) {\n\n    let existe: boolean = false;\n\n    await this.registroSerices.getRegistros().subscribe(responce => {\n      if (responce.filter(reg => reg.numeroIdentificacion == nIden).length > 0) {\n        existe = true;\n        //  console.log(responce.filter(reg => reg.numeroIdentificacion == 'MA253'))\n      }\n    }, error => console.error(error));\n    console.log(existe)\n\n    return await existe;\n  }\n\n}\n"]},"metadata":{},"sourceType":"module"}